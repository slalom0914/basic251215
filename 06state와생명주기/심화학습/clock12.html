<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>stateì™€ìƒëª…ì£¼ê¸°</title>
  <!-- React ë¼ì´ë¸ŒëŸ¬ -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <!-- ReactDOM ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- ë°”ë²¨ : JSX ì‚¬ìš© -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const root = document.querySelector("#root")
    const Clock = () => {
      console.log('11')
      //1) stateì„ ì–¸í•˜ê¸° - í˜„ì¬ ì‹œê°„(í™”ë©´ì— ì¶œë ¥í•  ë°ì´í„°)
      const [date, setDate] = React.useState(new Date())
      //2) stateì„ ì–¸í•˜ê¸° - íƒ€ì´ë¨¸ ì‹¤í–‰ ì—¬ë¶€(ì‹œì‘ë²„íŠ¼/ì •ì§€ë²„íŠ¼ ìŠ¤ìœ„ì¹˜)
      const [isRunning, setIsRunning] = React.useState(true)
      React.useEffect(() => {
        console.log('effect')
        //ì‹¤í–‰ ì¤‘ì´ ì•„ë‹ˆë©´ íƒ€ì´ë¨¸ ë§Œë“¤ì§€ ì•ŠìŒ
        if(!isRunning){
          console.log("[Clock] isRunning=false -> íƒ€ì´ë¨¸ ìƒì„± ì•ˆí•¨.")
          return //ì´ ë‹¤ìŒ ì½”ë“œëŠ” ì‹¤í–‰ ê¸°íšŒë¥¼ ê°–ì§€ ëª»í•œë‹¤. -> useEffectíƒˆì¶œ
        } 
        console.log("[Clock] íƒ€ì´ë¨¸ ì‹œì‘(setInterval ìƒì„±)")
        //1ì´ˆë§ˆë‹¤ dateê°±ì‹ 
        const timer = setInterval(() => {
          //state ì—…ë°ì´íŠ¸ í•œë‹¤. -> Reactê°€ ë‹¤ì‹œ ë Œë”ë§ ëœë‹¤. -> ì‹œê°„ì´ ê°±ì‹ ëœë‹¤ëŠ” ê²ƒì´ë‹¤.
          setDate(new Date())
        },1000) //ë‘ë²ˆì§¸íŒŒë¼ë¯¸í„° ìë¦¬ì— mili secë‹¨ìœ„ ì‹œê°„
        // cleanup: ì–¸ë§ˆìš´íŠ¸ ë˜ê±°ë‚˜ isRunningì´ ë°”ë€Œë©´ ì‹¤í–‰ë¨
        return () => {
          console.log("[Clock] cleanup ì‹¤í–‰ -> íƒ€ì´ë¨¸ ì œê±°(clearInterval)")
          clearInterval(timer)
        }
      },[isRunning]) //isRunningì´ ë°”ë€” ë•Œ ë§ˆë‹¤ useEffectì¬í‰ê°€
      //stateëŠ” ì´ì „ ìƒíƒœê°’ì„ ê¸°ì–µí•˜ê³  ìˆë‹¤.
      const toggleRunning = () => {
        setIsRunning((prev) => !prev)
      }
      return (
        <>
          <h2>í˜„ì¬ ì‹œê°„ : {date.toLocaleTimeString()}</h2>
          {/* isRunning ìƒíƒœì— ë”°ë¼ ë¬¸êµ¬ë„ ë‹¬ë¼ì§ */}
          <h3>ìƒíƒœ : {isRunning ? "ì‹¤í–‰ ì¤‘": "ì •ì§€"}</h3>
          {/* ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ stateê°€ ë°”ë€Œê³  í™”ë©´ì´ ìë™ ê°±ì‹ ì´ ë˜ëŠ”ê°€? ê´€ì°° */}
          <button onClick={toggleRunning}>
            {isRunning ? "ì •ì§€(stop)":"ì‹œì‘(Start)"}
          </button>
        </>
      )
    }//end of Clock
    //Clockì„ ë³´ì´ê¸°/ìˆ¨ê¸°ê¸° ë¡œ ì œì–´ -> boolean -> useState
    const App = () => {
      //ë¶€ëª¨ state : Clockì„ í™”ë©´ì— í‘œì‹œí• ì§€ ì—¬ë¶€
      const [isShowClock, setIsShowClock] = React.useState(true)
      const toggleClock = () => {
        setIsShowClock((prev) => !prev)
      }//end of toggleClock
      return (
        <>
          <h1>Unmount + Cleanup ì‹¤ìŠµ</h1>
          {/* Clock ë³´ì´ê¸°/ìˆ¨ê¸°ê¸° ë²„íŠ¼ */}
          <button onClick={toggleClock}>
            {isShowClock ? "Clockìˆ¨ê¸°ê¸°(ì–¸ë§ˆìš´íŠ¸)":"Clockë³´ì´ê¸°(ë§ˆìš´íŠ¸)"}
          </button>    
          {/* ì¡°ê±´ë¶€ ë Œë”ë§ : trueì¼ ë•Œë§Œ Clockì„ ë Œë”ë§í•˜ê¸° */}
          {isShowClock ? <Clock /> : <p>Clockì´ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.'</p>}
        </>
      )
    }//end of App(Parent)

    ReactDOM.createRoot(root).render(<App />)
  </script>
</body>
</html>
<!-- 
ğŸ¯ í•™ìŠµëª©í‘œ (State + useEffect Clock í™•ì¥ ì‹¤ìŠµ)

ì´ë²ˆ ì‹¤ìŠµì„ í†µí•´ í›ˆë ¨ìƒì€ ë‹¤ìŒì„ ì§ì ‘ ë§Œë“¤ì–´ë³´ë©° ì´í•´í•œë‹¤.

1ï¸âƒ£ Reactì˜ state ê°œë…ì„ ì´í•´í•œë‹¤

í™”ë©´ì— ë³´ì—¬ì§€ëŠ” ê°’ì€ ë³€ìˆ˜ê°€ ì•„ë‹ˆë¼ stateë¡œ ê´€ë¦¬í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì´í•´í•œë‹¤.

useState()ë¥¼ ì‚¬ìš©í•˜ì—¬

í˜„ì¬ ì‹œê°„ì„ ì €ì¥í•˜ëŠ” date ìƒíƒœ

íƒ€ì´ë¨¸ ì‹¤í–‰ ì—¬ë¶€ë¥¼ ì œì–´í•˜ëŠ” isRunning ìƒíƒœ(boolean)
ë¥¼ ê°ê° ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.

2ï¸âƒ£ state ë³€ê²½ â†’ ë¦¬ë Œë”ë§ íë¦„ì„ ì²´ê°í•œë‹¤

setDate()ê°€ í˜¸ì¶œë˜ë©´
â†’ Reactê°€ ìë™ìœ¼ë¡œ í™”ë©´ì„ ë‹¤ì‹œ ê·¸ë¦°ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•œë‹¤.

ë²„íŠ¼ í´ë¦­ â†’ state ë³€ê²½ â†’ í™”ë©´ ìë™ ê°±ì‹ ì˜ íë¦„ì„ ì´í•´í•œë‹¤.

3ï¸âƒ£ useEffectì˜ ì—­í• ì„ ì´í•´í•œë‹¤

useEffectëŠ” íƒ€ì´ë¨¸, ì´ë²¤íŠ¸, ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì²˜ëŸ¼
"ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ ë™ì‘(ë¶€ìˆ˜íš¨ê³¼)"ì„ ì²˜ë¦¬í•˜ëŠ” ê³µê°„ì„ì„ ì´í•´í•œë‹¤.

setInterval() ê°™ì€ ì½”ë“œëŠ”
JSX ì•ˆì´ ì•„ë‹ˆë¼ useEffect ì•ˆì—ì„œ ê´€ë¦¬í•´ì•¼ í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

4ï¸âƒ£ ì˜ì¡´ì„± ë°°ì—´([isRunning])ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•œë‹¤

[isRunning]ì´ ìˆë‹¤ëŠ” ê²ƒì€
â†’ isRunning ê°’ì´ ë°”ë€” ë•Œë§ˆë‹¤ effectê°€ ë‹¤ì‹œ ì‹¤í–‰ëœë‹¤ëŠ” ëœ»ì„ì„ ì´í•´í•œë‹¤.

ì‹œì‘(Start) / ì •ì§€(Stop) ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œ
useEffectê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ëˆˆìœ¼ë¡œ í™•ì¸í•œë‹¤.

5ï¸âƒ£ cleanup í•¨ìˆ˜ì˜ í•„ìš”ì„±ì„ ì´í•´í•œë‹¤

return () => clearInterval()ì´
ê¸°ì¡´ íƒ€ì´ë¨¸ë¥¼ ì •ë¦¬í•˜ëŠ” ì—­í• ì„ì„ ì´í•´í•œë‹¤.

cleanupì´ ì—†ìœ¼ë©´
â†’ íƒ€ì´ë¨¸ê°€ ì¤‘ë³µ ì‹¤í–‰ë˜ì–´ ì‹œê°„ì´ ë¹¨ë¼ì§€ëŠ” ë²„ê·¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒì„ ì´í•´í•œë‹¤.

Reactì—ì„œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë§‰ëŠ” ê¸°ë³¸ íŒ¨í„´ì„ í•™ìŠµí•œë‹¤.

6ï¸âƒ£ ìƒíƒœ(state)ë¡œ "ë™ì‘ì„ ì œì–´"í•  ìˆ˜ ìˆìŒì„ ì´í•´í•œë‹¤

dateëŠ” ë³´ì—¬ì¤„ ë°ì´í„°

isRunningì€ ë™ì‘ì„ ì œì–´í•˜ëŠ” ìŠ¤ìœ„ì¹˜
ë¼ëŠ” ì—­í•  ì°¨ì´ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.

ë‹¨ìˆœ ì¶œë ¥ìš© stateì™€
ë¡œì§ ì œì–´ìš© stateë¥¼ ë‚˜ëˆ„ì–´ ì„¤ê³„í•˜ëŠ” ê°ê°ì„ ê¸°ë¥¸ë‹¤.

7ï¸âƒ£ ì‹¤ì œ ì„œë¹„ìŠ¤ì— ì“°ì´ëŠ” íŒ¨í„´ì„ ê²½í—˜í•œë‹¤

ì‹œê³„, íƒ€ì´ë¨¸, ë¡œë”© ì• ë‹ˆë©”ì´ì…˜, ìë™ ìƒˆë¡œê³ ì¹¨ ê¸°ëŠ¥ ë“±
ì‹¤ë¬´ì—ì„œ ìì£¼ ì“°ì´ëŠ” êµ¬ì¡°ë¥¼ ì§ì ‘ êµ¬í˜„í•´ë³¸ë‹¤.

"ì»´í¬ë„ŒíŠ¸ ìƒì„± â†’ íƒ€ì´ë¨¸ ì‹œì‘ â†’ ì •ì§€ â†’ ì¬ì‹œì‘ â†’ ì œê±°"
ë¼ëŠ” ì „ì²´ ìƒëª…ì£¼ê¸° íë¦„ì„ ì´í•´í•œë‹¤.
-->